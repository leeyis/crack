# 高效手机号码字典生成脚本 (gen_phone_dic.sh)

## 概述

`gen_phone_dic.sh` 是一个高效手机号码字典生成脚本。

## 主要特性

### 🚀 高性能
- 使用 `seq` 命令批量生成，比传统循环快5-10倍
- 优化的文件写入操作
- 高效的内存使用

### 🌍 完整城市支持
- 支持300+个中国城市的拼音映射
- 覆盖全国34个省、自治区、直辖市
- 包括所有省会城市、重要地级市、县级市
- 支持城市群组合命名
- 自动处理未知城市名

### 📊 友好的进度显示
- 可视化进度条 (使用 █ 和 ░ 字符)
- 实时百分比显示
- 剩余时间估算 (ETA)
- 处理速度统计

### 🛡️ 完善的错误处理
- 文件存在性检查
- 文件内容验证
- 用户确认机制
- 详细的错误提示

## 使用方法

```bash
./gen_phone_dic.sh <csv文件名>
```

### 示例
```bash
./gen_phone_dic.sh phone_segments.csv
```

## CSV文件格式

CSV文件应包含以下列：
```
城市名,运营商名,3位数号段,7位数号段
武汉,中国移动,134,1347701
武汉,中国移动,134,1341959
武汉,中国移动,135,1350123
```

## 输出

- **文件名**: `{城市拼音}.txt`
- **内容**: 11位完整手机号码 (7位号段 + 0000-9999)
- **格式**: 每行一个手机号码

### 输出示例
```
13477010000
13477010001
13477010002
...
13477019999
```

## 支持的城市

脚本现已支持 **300+** 个中国城市，覆盖全国所有省、自治区、直辖市的主要城市。

### 按省份分类支持的城市

#### 直辖市 (4个)
- **北京市**: 北京
- **天津市**: 天津
- **上海市**: 上海
- **重庆市**: 重庆、黔江、万州、涪陵

#### 省会及主要城市 (部分列表)

**山东省 (16个)**
济南、青岛、烟台、潍坊、临沂、淄博、济宁、泰安、聊城、威海、枣庄、德州、滨州、东营、日照、菏泽

**江苏省 (13个)**
南京、苏州、无锡、常州、徐州、南通、扬州、盐城、淮安、连云港、镇江、宿迁、泰州

**广东省 (21个)**
广州、深圳、东莞、佛山、中山、珠海、惠州、江门、汕头、湛江、茂名、肇庆、梅州、汕尾、河源、阳江、清远、潮州、揭阳、云浮、韶关

**浙江省 (11个)**
杭州、宁波、温州、嘉兴、湖州、绍兴、金华、衢州、舟山、台州、丽水

**四川省 (21个)**
成都、绵阳、德阳、南充、宜宾、自贡、乐山、泸州、达州、内江、遂宁、攀枝花、眉山、广安、雅安、巴中、资阳、广元、西昌、凉山、甘孜、阿坝等

**河南省 (18个)**
郑州、洛阳、新乡、南阳、许昌、平顶山、安阳、焦作、商丘、开封、漯河、濮阳、周口、信阳、驻马店、鹤壁、三门峡、济源

**湖北省 (17个)**
武汉、宜昌、襄阳、荆州、十堰、黄石、荆门、黄冈、随州、咸宁、孝感、鄂州、恩施、仙桃、潜江、神农架、江汉

**安徽省 (16个)**
合肥、芜湖、蚌埠、阜阳、淮南、安庆、宿州、六安、淮北、铜陵、宣城、池州、亳州、黄山、滁州、马鞍山

**湖南省 (14个)**
长沙、株洲、湘潭、衡阳、岳阳、常德、张家界、益阳、郴州、永州、怀化、娄底、邵阳、湘西

**河北省 (11个)**
石家庄、唐山、保定、秦皇岛、邯郸、邢台、沧州、承德、张家口、廊坊、衡水

**山西省 (11个)**
太原、大同、阳泉、长治、晋城、朔州、晋中、运城、忻州、临汾、吕梁

**陕西省 (10个)**
西安、宝鸡、咸阳、渭南、汉中、安康、商洛、延安、榆林、铜川

**江西省 (11个)**
南昌、九江、景德镇、萍乡、新余、鹰潭、赣州、宜春、上饶、吉安、抚州

**福建省 (9个)**
福州、厦门、莆田、三明、泉州、漳州、南平、龙岩、宁德

**吉林省 (9个)**
长春、吉林、四平、辽源、通化、白山、松原、白城、延边

**辽宁省 (14个)**
沈阳、大连、鞍山、抚顺、本溪、丹东、锦州、营口、阜新、辽阳、盘锦、铁岭、朝阳、葫芦岛

**黑龙江省 (13个)**
哈尔滨、齐齐哈尔、鸡西、鹤岗、双鸭山、大庆、伊春、佳木斯、七台河、牡丹江、黑河、绥化、大兴安岭

**内蒙古自治区 (12个)**
呼和浩特、包头、乌海、赤峰、通辽、鄂尔多斯、呼伦贝尔、巴彦淖尔、乌兰察布、兴安、锡林郭勒、阿拉善

**广西壮族自治区 (14个)**
南宁、柳州、桂林、梧州、北海、防城港、钦州、贵港、玉林、百色、贺州、河池、来宾、崇左

**云南省 (16个)**
昆明、曲靖、玉溪、保山、昭通、丽江、普洱、临沧、楚雄、红河、文山、西双版纳、大理、德宏、怒江、迪庆

**贵州省 (9个)**
贵阳、六盘水、遵义、安顺、毕节、铜仁、黔西南、黔东南、黔南

**甘肃省 (14个)**
兰州、嘉峪关、金昌、白银、天水、武威、张掖、平凉、酒泉、庆阳、定西、陇南、临夏、甘南

**青海省 (8个)**
西宁、海东、海北、海南、海西、黄南、果洛、玉树

**宁夏回族自治区 (5个)**
银川、石嘴山、吴忠、固原、中卫

**新疆维吾尔自治区 (14个)**
乌鲁木齐、克拉玛依、吐鲁番、哈密、昌吉、博尔塔拉、巴音郭楞、阿克苏、克孜勒苏、喀什、和田、伊犁、塔城、阿勒泰

**西藏自治区 (7个)**
拉萨、昌都、山南、日喀则、那曲、阿里、林芝

**海南省 (2个)**
海口、三亚

**港澳台 (3个)**
香港、澳门、台北

### 特殊支持
- 支持城市群组合命名（如：成都/眉山/资阳、长沙/湘潭/株洲等）
- 自动处理未知城市名（使用原名并给出警告）
- 完整的拼音转换，避免文件名冲突

*完整的城市列表和拼音映射请查看脚本中的 `get_city_pinyin()` 函数*

## 性能对比

| 脚本 | 生成方式 | 相对速度 | 城市支持 | 进度显示 |
|------|----------|----------|----------|----------|
| generate_dict.sh | 双重循环 | 1x | 40+ | 详细进度条 |
| generate_dict_fast.sh | seq命令 | 5-10x | 3个 | 简单百分比 |
| **gen_phone_dic.sh** | **seq命令** | **5-10x** | **300+** | **增强进度条+ETA** |

## 功能特点

### 1. 高效生成算法
```bash
# 使用seq命令批量生成 (来自fast版本)
seq -f "${segment}%04.0f" 0 9999 >> "$OUTPUT_FILE"
```

### 2. 增强的进度显示
```
[████████████████████████████████████████] 100% (150/150) ETA: 0s
```

### 3. 详细的统计信息
- 实际生成数量
- 文件大小
- 总耗时
- 生成速度 (号码/秒)

### 4. 文件预览
- 显示前5行和后5行
- 便于快速验证结果

## 错误处理

脚本会检查并处理以下情况：
- 参数数量错误
- CSV文件不存在
- CSV文件为空
- 无法提取城市名
- 输出文件已存在 (询问是否覆盖)

## 性能优化建议

1. **大文件处理**: 对于超大CSV文件，建议分批处理
2. **磁盘空间**: 确保有足够的磁盘空间 (每万个号码约120KB)
3. **内存使用**: 脚本内存占用很小，主要消耗在磁盘I/O

## 与原脚本的兼容性

- 完全兼容原有的CSV格式
- 输出格式保持一致
- 可以直接替换原脚本使用

## 许可证

本脚本基于原有脚本改进，保持相同的使用条款。
